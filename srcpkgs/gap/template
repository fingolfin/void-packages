# Template file for 'gap'
pkgname=gap
version=4.12.1
revision=1
build_style=gnu-configure
make_install_target="install"
makedepends="gmp-devel zlib-devel readline-devel"
checkdepends="perl"
short_desc="Groups, Algorithms, Programming - computational discrete algebra"
maintainer="Gonzalo Tornar√≠a <tornaria@cmat.edu.uy>"
license="GPL-2.0-or-later"
homepage="https://www.gap-system.org/"
distfiles="https://github.com/gap-system/gap/releases/download/v${version}/gap-${version}.tar.gz"
checksum=f9ebef11ee31b210ce36e3c70960742b4e253282bbd5270adc9324273c92b016

if [ "$XBPS_CHECK_PKGS" = full ]; then
	# not sure about this -- takes about 25 minutes
	make_check_target=teststandard
fi

_GAPROOT=/usr/share/gap/

# minimal required packages
_GAPPKGS="gapdoc primgrp smallgrp transgrp"

# other expected packages
_GAPPKGS+=" atlasrep autpgrp alnuth crisp ctbllib factint fga irredsol laguna
 polenta polycyclic resclasses sophus tomlib utils"

post_install() {
	vmkdir ${_GAPROOT}/pkg
	for p in ${_GAPPKGS}; do
		[ -d pkg/$p ] || p="$p-*"
		vcopy "pkg/$p" ${_GAPROOT}/pkg
	done
}

gap-devel_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.so"
	}
}
